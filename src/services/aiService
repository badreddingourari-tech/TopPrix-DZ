import Groq from "groq-sdk";

const groqClient = new Groq({
    apiKey: process.env.GROQ_API_KEY
});

export class AIService {
    static async getSmartResponse(userMessage, userName = "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…") {
        try {
            console.log("ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Groq AI...");

            const response = await groqClient.chat.completions.create({
                model: "llama-3.1-8b-instant",
                messages: [
                    {
                        role: "system",
                        content: "Ø£Ù†Øª Ø¨ÙˆØª Ø£Ø³ÙˆØ§Ù‚ Ø¬Ø²Ø§Ø¦Ø±ÙŠØ© Ø°ÙƒÙŠ. Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± Ø£Ùˆ Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø± Ø¢Ø®Ø±."
                    },
                    {
                        role: "user", 
                        content: `${userName} ÙŠÙ‚ÙˆÙ„: "${userMessage}"`
                    }
                ],
                temperature: 0.7,
                max_tokens: 500
            });

            const aiResponse = response.choices[0]?.message?.content;
            console.log("âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ");
            return aiResponse;

        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ:", error.message);
            return "Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ø¨ÙˆØª TopPrix DZ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ";
        }
    }
}
